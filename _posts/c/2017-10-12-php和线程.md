---
layout: post
title: php和线程
subtitle: 
author: 刘邦
weather: sunny
catalog: true
tags: [c,php]
category: c
use_math: true
---

## 简介

PHP和线程，单凭这简短的几个字，就足以写一本书。像往常一样，我们不会这么做，但是会给出一定程度上跟这个话题相关的信息与细节。让我们从一些人在谈论这个话题时通常感到的困惑开始，PHP不是一种线程语言，
PHP的内核没有使用线程，而且PHP天生也不允许用户层代码通过任何方式使用多线程作为并发机制。

因此PHP跟其他一些技术有很大的区别，例如Java。Java不仅自身使用了大量的线程，它还允许用户通过编程来是用线程。然而，PHP不适用线程是有它的原因的。

PHP内核没有使用线程，主要是为了简化开发。当你读到下一节的时候，你就会了解到线程并不是一个能使任何程序都能更快运行的魔法技术。是不是听起来很像是在推销不是吗？但是我们不是推销，而是谈论技术，而且
我们很清楚我们在说什么。因此PHP引擎目前没有使用多线程，也许将来会使用。但是使用多线程在编程上会引发很多问题，例如程序运行结果不是你所期待的等等。主要的困难是跨平坦的多线程编程，其次就是资源共享和
锁的管理，再次就是并不是所有的程序都能够被转化成多线程程序。PHP的设计主要在2000前后，在那个时候，多线程编程并不是很广泛和成熟，PHP引擎开发工程师决定创造一个完全没有线程的单片机引擎（当然他们也没有
足够的能力去驾驭一个稳定的跨平台的多线程引擎）。

PHP用户层代码也不允许使用线程，因为那不是PHP期待你的代码运行的方式。PHP是一个"发送并忘记(fire-and-forget)"型的语言，你应该尽可能快的处理完请求，然后释放，然后接着处理下一个请求。PHP被设计作为一种
胶水语言：你不用处理可能使用到线程的复杂任务，而是访问快速而且已经准备好的资源，将它们粘合到一起，然后再返回给用户。通过PHP，无论什么可能花费比通常时间多的时间的任务，都不能用PHP来处理。这就是为什么
在PHP中我们通常使用基于消息队列的系统(Gearman, AMQP, ActiveMQ 等等)来异步处理一些耗时任务。正如Unix看待事物的方式：“开发小而完备的工具，然后将他们连接在一起”。因此PHP的设计不是允许大规模的并行，而是
其他专门的技术--是用正确的工具来解决特定的问题。

## 线程的简介

让我们来快速的介绍下线程。注意，我们不会阐述太多细节的东西，对于你想深入了解关于线程的任何细节，都可以在相关书籍和站点上找到。

线程是进程中的轻量的事务处理单元，注意，一个进程可以产生多个线程，一个线程必须有且只能属于一个进程。进程是操作系统中的基本工作处理单元.
